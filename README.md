# Wallhaven壁纸下载器

一个基于PyQt5的Wallhaven壁纸批量下载工具，支持多种下载方式和自定义设置。

## 功能特性

- 🖼️ **多种下载方式**：支持下载最新壁纸、从指定类别下载、通过关键词搜索下载
- 🚀 **并发下载**：支持多线程并发下载，提高下载效率
- 🎨 **美观界面**：采用液态玻璃效果设计，支持浅色/深色主题切换
- 🔍 **图片预览**：实时预览已下载的图片
- 📁 **自定义下载目录**：可自由选择壁纸保存位置
- ⚙️ **丰富设置**：可调整并发数、超时时间、预览大小等参数
- 📋 **下载页数无限制**：可设置任意页数进行下载

## 安装方法

### 方法一：直接运行可执行文件

1. 从[Releases](https://github.com/XQGIN/wallhaven_downloader/releases)页面下载最新的`WallpaperDownloader.exe`安装程序
2. 双击运行安装程序，按照提示完成安装
3. 安装完成后，可以从桌面快捷方式或开始菜单启动程序

### 方法二：从源码运行

1. 确保已安装Python 3.7+和pip
2. 克隆本仓库：
   ```
   git clone https://github.com/XQGIN/wallhaven_downloader.git
   cd wallhaven_downloader
   ```
3. 安装依赖：
   ```
   pip install -r requirements.txt
   ```
4. 运行程序：
   ```
   python main.py
   ```

## 使用说明

1. **选择下载方式**：在左侧面板中选择"下载最新壁纸"、"从指定类别下载"或"从搜索下载"
2. **设置下载参数**：
   - 如果选择类别下载，请选择相应的类别和纯度
   - 如果选择搜索下载，请输入搜索关键词
   - 设置下载页数和下载目录
3. **点击开始下载**：程序将开始下载壁纸并显示进度
4. **查看下载结果**：右侧面板会显示已下载的图片预览
5. **调整设置**：点击"设置"按钮可以调整应用的各项参数

## 项目结构

```
wallhaven_downloader/
├── src/                # 源代码目录
│   ├── main_window.py  # 主窗口实现
│   └── __init__.py
├── main.py             # 程序入口
├── icon/               # 图标资源
├── requirements.txt    # 依赖列表
├── settings.json       # 默认设置配置
```

## 开发环境

- Python 3.11
- PyQt5 5.15.9
- requests 2.31.0
- Pillow 10.0.0
- psutil 5.9.5

## 最新更新

### 版本 1.0.0

#### 新增功能
- **进程自动管理**：程序关闭或退出后自动关闭所有后台进程，确保系统资源得到释放
- **增强的关闭处理**：优化了程序关闭逻辑，支持线程超时等待和强制终止机制
- **改进的安装程序**：优化了INNO Setup脚本，提供更完善的安装和卸载体验

#### 技术改进
- 添加了psutil库支持，用于更精确的进程管理
- 优化了closeEvent处理逻辑，确保所有子进程在程序退出前被正确关闭
- 增强了安装程序的错误处理和用户提示

#### 依赖更新
- 新增psutil==5.9.5依赖，用于进程管理功能

## License


[MIT](LICENSE)
