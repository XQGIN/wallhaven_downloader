# Wallhaven壁纸下载器 - 发行说明

## 版本 1.1.0

### 发布日期

2024年6月

### 主要更新

本次更新主要优化了程序的进程管理和安装体验，确保程序退出后所有后台进程能够正确关闭，并改进了安装程序的稳定性和用户体验。

#### 新增功能
- **进程自动管理**：程序关闭或退出后自动关闭所有后台进程，确保系统资源得到释放
- **增强的关闭处理**：优化了程序关闭逻辑，支持线程超时等待和强制终止机制
- **改进的安装程序**：优化了INNO Setup脚本，提供更完善的安装和卸载体验

#### 技术改进
- 添加了psutil库支持，用于更精确的进程管理
- 优化了closeEvent处理逻辑，确保所有子进程在程序退出前被正确关闭
- 增强了安装程序的错误处理和用户提示
- 改进了PyInstaller打包配置，确保所有依赖项正确包含

#### 依赖更新
- 新增psutil==5.9.5依赖，用于进程管理功能

#### 修复问题
- 修复了程序退出后后台进程可能继续运行的问题
- 改进了多线程下载时的资源清理机制
- 优化了安装程序在Windows系统上的兼容性

### 包含文件

本发行版包含以下文件：

- **WallpaperDownloader.exe**：主程序可执行文件
- **_internal/**：包含程序运行所需的所有依赖文件和资源
  - Python运行时库
  - PyQt5相关组件
  - 图片处理库
  - psutil进程管理库
  - 图标资源
  - 配置文件

### 系统要求

- **操作系统**：Windows 7/8/10/11
- **处理器**：Intel Core i3或同等性能处理器
- **内存**：至少4GB RAM
- **磁盘空间**：至少150MB可用空间（不包括下载的壁纸）
- **分辨率**：推荐1920x1080或更高分辨率显示器

### 安装说明

1. 下载`WallpaperDownloader_Setup_v1.1.0.exe`安装程序
2. 双击运行安装程序，按照安装向导的提示完成安装
3. 安装完成后，可以从桌面快捷方式或开始菜单启动程序

### 绿色版使用说明

如果您下载的是绿色版（ZIP压缩包）：

1. 解压下载的ZIP文件到任意目录
2. 找到并双击`WallpaperDownloader.exe`文件运行程序
3. 首次运行时，程序会在默认位置创建配置文件

### 使用注意事项

1. **网络连接**：程序需要稳定的网络连接才能下载壁纸
2. **权限要求**：请确保您有写入下载目录的权限
3. **防火墙设置**：如果下载失败，可能需要检查防火墙设置是否阻止了程序的网络访问
4. **API限制**：Wallhaven网站可能有访问限制，如遇到下载失败，请稍后再试
5. **进程管理**：程序退出时会自动关闭所有相关进程，确保系统资源得到释放

### 常见问题解决

**问题**：程序无法启动或崩溃
**解决方法**：请确保您的Windows系统已安装所有必要的Visual C++ Redistributable包

**问题**：下载速度很慢
**解决方法**：可以在设置中调整并发下载数，但不建议设置过高，以免触发网站的访问限制

**问题**：下载的图片不完整或无法打开
**解决方法**：检查网络连接是否稳定，或尝试降低并发下载数

**问题**：程序退出后仍有进程在后台运行
**解决方法**：本版本已优化进程管理，如仍有问题，请尝试通过任务管理器手动结束相关进程

### 更新日志

**版本 1.1.0**
- 优化程序进程管理，确保退出时自动关闭所有后台进程
- 添加psutil库支持，提供更精确的进程控制
- 改进程序关闭逻辑，支持线程超时等待和强制终止
- 优化INNO Setup安装脚本，提供更完善的安装和卸载体验
- 更新PyInstaller打包配置，确保所有依赖项正确包含

**版本 1.0.0**
- 首次发布
- 实现基本的壁纸下载功能
- 支持多种下载方式
- 添加预览功能
- 解除下载页数限制

### 联系与反馈

如有任何问题或建议，请在GitHub项目页面提交Issue或Pull Request。

[GitHub项目地址](https://github.com/XQGIN/wallhaven_downloader)